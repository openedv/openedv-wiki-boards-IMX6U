---
title: '固化系统'
sidebar_position: 2
---

# 固化系统

开发板出厂已经固化系统到核心板上的eMMC或NandFlash存储介质里。建议自行更新系统固件（检查是不是最新系统，请看1.2.2小节），新的系统修复可能存在的bug、优化程序及添加新的功能。如果不需要重新固化系统，请直接到2.3节登录开发板。
正点原子提供两种固化系统方式，第一种方式(NXP官方提供的方法)是使用正点原子修改过的NXP官方的上位机工具mfgtool。这种固化系统方式可以使用PC机在线直接固化系统。第二种方法（正点原子额外提供的方法）需要制作TF卡系统卡，插卡的方式固化系统。这两种方法都有各自的好处。下面将介绍它们的用法。


## 使用mfgtool上位机固化系统（OTG方式）

以ALPHA底板为例，请先插上开发板的12v电源，OTG接口不能供电给开发板。底板拨码开关BOOT_CFG设置如下，设置为USB连接方式，“1”代码ON，“0”代表“OFF”。将拨码数字2处拨到ON，其他的为OFF，如下图。

![2.2.1](./img/2.2.1.png)

使用USB连接线连接底板的USB_OTG接口与PC机（电脑）。(注：MINI底板的位置不一样。)

![2.2.2](./img/2.2.2.png)

进入开发板光盘A-基础资料->5、开发工具->4、正点原子MFG_TOOL出厂固件烧录工具->mfgtool文件夹下，查看vbs脚本信息，如下图。

![2.2.3](./img/2.2.3.png)

用户不需要知道这么多vbs脚本怎么用，。目前正点原子在售的核心板类型只有两种，一种是eMMC（8GB）核心板类型，DDR大小为512MB。另一种是NandFlash（512MB），DDR大小为256MB。vbs脚本解释如下:
以Mfgtool2-eMMC-ddr512-eMMC.vbs为例。
-eMMC：代表核心板上的存储介质为eMMC
-ddr512：指核心板上的DDR大小为512MB
-eMMC：选择此脚本是把固件烧写到eMMC上

### 固化系统到TF卡

用户需要准备一张TF卡，按前面的vbs脚本命名解释，比如要固化系统到TF(SDCard)卡，那么需要确认用户手上的核心板类型是eMMC还是NandFlash。比如现在用户手上核心板类型为eMMC类型核心板。所以我们选择Mfgtool2-eMMC-ddr512-SDCard.vbs这个脚本来烧写 ，如果是用户手上核心板类型NandFlash核心板，则选择Mfgtool2-NAND-ddr256-SDCard.vbs。
比如编者手上的是eMMC核心板，要固化系统到TF卡上，按2.2.1小节拨码及连接方式，开发板上电，双击Mfgtool2-eMMC-ddr512-SDCard.vbs
常见问题：
1.	若没有任何反应，可能是被杀毒软件拦截，请退出杀毒软件！
2.	如果是第一次使用开发板OTG连接PC机（电脑），需要等待PC（电脑）机自动安装驱动。点击右下角正在安装驱动的小图标，不要让Winodws去从Windows update里去找驱动，点击跳过，驱动自然会装上。否则用了Windows update里的驱动，可能在烧写过程中会卡住，不往下跑。
3.	等待安装驱动完成后，mfgtool上位机界面会提示已经连接到设备HID-compliant device，注意请不要打开虚拟机，如果虚拟机正在开启，OTG会连接到虚拟机上去。在烧写时，如果遇到杀毒报错，建议关闭杀毒软件！
4.	若烧写到一半卡住，有可能是mfgtool的路径太长或者含中文路径！请拷贝mfgtool文件夹到桌面再烧写！ 

![2.2.4](./img/2.2.4.png)

此时将TF卡插入卡槽（需开发板先上电后再将TF卡插进卡槽，否则上电时会检测TF卡，这样mfgtool会连接不到开发板设备），如下图插上SD卡（MINI底板卡槽的位置不一样）。

![2.2.5](./img/2.2.5.png)

直接点击mfgtool的Start按钮进行固化系统到SD卡。下图为点击Start按钮后的截图。固化系统到SD卡需要几分钟时间，请耐心等待。

![2.2.6](./img/2.2.6.png)

下图为固化过程中的一步，正在写入文件系统.

![2.2.7](./img/2.2.7.png)

固化完成如下图，点击Stop后再点Exit退出mfgtool上位机软件即可。

![2.2.8](./img/2.2.8.png)

测试从SD卡启动系统，拨码开关拨至SD卡启动方式10000010，启动系统即可。

### 固化系统到eMMC

使用前提:用户核心板类型带eMMC存储介质。目前原子在售的eMMC核心板ddr大小是512MB。请双击Mfgtool2-eMMC-ddr512-eMMC.vbs这个vbs脚本文件进行固化。
请参考2.2.1 1小节固化系统到SD卡的步骤（注：固化时不要插入SD卡），选择固化到eMMC的vbs文件，固化完成后，将拨码开关拨至eMMC启动方式10100110，启动系统即可。


###  固化系统到NAND FLASH

使用前提:用户核心板类型带NAND FLASH存储介质。目前原子在售的NAND FLASH核心板都是ddr大小是256MB。请双击Mfgtool2-NAND-ddr256-NAND.vbs这个vbs脚本文件进行固化。
请参考2.2.1.1小节固化系统到SD卡的步骤（注：固化时不要插入SD卡），选择固化到NAND FLASH的vbs文件，固化完成后，将拨码开关拨至NAND启动方式10001001，启动系统即可。


## 使用脚本固化系统



## 登录开发板
